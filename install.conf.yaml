- defaults:
    link:
      relink: true
      create: true
      force: true
- clean: ["~"]
- create:
    - ~/.config/
    - ~/Coding/
    - ~/Coding/Playground
    - ~/Coding/Personal
    - ~/Coding/Tutero
- shell:
    - [git submodule update --init --recursive, Installing submodules]
    - [
        xcode-select --version | grep -q "version .*" && echo "xcode-select --install",
        Checking if Xcode Command Line Tools are installed,
      ]
    - command: brew -v || /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
      stdin: true
      stdout: true
      quiet: true
      description: Installing homebrew
    - [brew tap Homebrew/bundle, Setup brew bundle]
    - command: brew bundle
      stdout: true
      quiet: true
      description: Installing homebrew dependencies
    - command: if [ (basename $SHELL) != "fish" ]; chsh -s /opt/homebrew/bin/fish; end
      stdin: true
      stderr: true
      quiet: true
      description: Making fish the default shell
    - command: gh auth status || gh auth login
      stdin: true
      stdout: true
      stderr: true
      quiet: false
      description: Authenticate with GitHub
    - command: ./install_fonts
      quiet: true
      description: Installing fonts
    - command: ./install_fisher
      quiet: true
      description: Installing fish dependencies
    - command: type -q rustup || curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
      stdin: true
      stdout: true
      stderr: true
      quiet: true
      description: Installing rust
    - command: ./build_neovim
      stdin: true
      stdout: true
      quiet: true
      description: Building neovim
- link:
    ~/.gitconfig:
    ~/.ssh/config:
      path: ssh/config
    ~/.tmux.conf:
    ~/.config/nvim:
      path: config/nvim
    ~/.config/fish:
      path: config/fish
    ~/.config/yabai:
      path: config/yabai
    ~/.config/skhd:
      path: config/skhd
    ~/.config/tridactyl:
      path: config/tridactyl
    ~/.config/tmux:
      path: config/tmux
    ~/.config/kitty:
      path: config/kitty
    ~/.config/gitui:
      path: config/gitui
    ~/.config/starship.toml:
      path: config/starship.toml
    ~/.config/k9s:
      path: config/k9s
    ~/.config/lazydocker:
      path: config/lazydocker
    ~/.config/omf:
      path: config/omf
    ~/.config/raycast:
      path: config/raycast
    ~/.config/gobang:
      path: config/gobang
- shell:
    - ln -s ~/.config/tmux/tmux.conf.local ~/.tmux.conf.local || true
    - command: >
        if not brew services | grep "yabai.*started" > /dev/null
          brew services start yabai
          set sa_exists 1
        end
      quiet: true
      stderr: true
      description: Starting yabai
    - command: brew services restart skhd
      quiet: true
      stderr: true
      description: Starting skhd
    - command: >
        if set -q sa_exists
          sudo yabai --install-sa
          sudo yabai --load-sa
        end
      quiet: true
      stderr: true
      description: Loading yabai SA
